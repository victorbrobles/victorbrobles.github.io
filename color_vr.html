<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Laser Controls</title>
  <meta name="description" content="Laser Controls - A-Frame">
  <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
  <script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/v4.1.2/dist/aframe-extras.min.js"></script>
</head>

<body>
  <script>

      function getRandomColor() {
        var letters = '0123456789ABCDEF';
        var color = '#';
        for (var i = 0; i < 6; i++) {
          color += letters[Math.floor(Math.random() * 16)];
        }
        return color;
      }


      AFRAME.registerComponent('intersect-color-change', {
        init: function () {
          var el = this.el;
          var material = el.getAttribute('material');
          var initialColor = material.color;
          var self = this;

          el.addEventListener('abuttondown', function() {
            el.setAttribute('color', getRandomColor());
          });

          el.addEventListener('bbuttondown', function() {
            el.setAttribute('color', getRandomColor());
          });

          el.addEventListener('xbuttondown', function() {
            el.setAttribute('color', getRandomColor());
          });

          el.addEventListener('ybuttondown', function() {
            el.setAttribute('color', getRandomColor());
          });

      //    el.addEventListener('mousedown', function (evt) {
        //    el.setAttribute('material', 'color', '#EF2D5E');
        //  });

          //el.addEventListener('mouseup', function (evt) {
            //el.setAttribute('material', 'color', self.isMouseEnter ? '#24CAFF' : initialColor);
          //});

          //el.addEventListener('mouseenter', function () {
          //  el.setAttribute('material', 'color', '#24CAFF');
            //self.isMouseEnter = true;
          //});

          //el.addEventListener('mouseleave', function () {
            //el.setAttribute('material', 'color', initialColor);
            //self.isMouseEnter = false;
          //});
        }
      });
    </script>
    <a-scene environment="preset: starry; grid: none; groundTexture: walkernoise">
      <a-entity light="type: ambient; color: #CCC"></a-entity>
      <a-entity position="0 1.6 0" camera look-controls wasd-controls></a-entity>
      <a-entity id="leftHand" laser-controls="hand: left" raycaster="objects: [mixin='box']"></a-entity>
      <a-entity id="rightHand" laser-controls="hand: right" raycaster="objects: [mixin='box']" line="color: #118A7E"></a-entity>

      <a-entity position="0 -1.6 -10">
        <a-mixin id="box" geometry="primitive: box" material="color: #FAFAFA" intersect-color-change shadow="cast: true; receive: false"></a-mixin>
        <a-entity>
          <a-entity mixin='box' position='0 0 0'></a-entity>
        </a-entity>
      </a-entity>
    </a-scene>
</body>
</html>
